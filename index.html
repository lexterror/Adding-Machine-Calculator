<html>
<head>

<script>

var total = 0;
var position = 0;
var current = 0;
var type = ""; 
var array = [];
var arraytype = [];
var arraynumber = [];
var del_entry = 0;
var positionfake = 0;
var mylength = 0;
var subtotal = 0;
var listnumber = 0;
var getrightsub = [];
var previous = 0;
var addthese = [];
var addthese2 = [];
var onlyone = 0;
var previous = 0;
var next = 0;
var result = 0;

var removeadd = 0;
var removesubtract = 0;
var removedivide = 0;
var removemultiply = 0;

var removenpercentage = 0;
var removep = 0;
var removepercentage = 0;
var removem = 0;

var getrightsum = 0;


	

function submit() {
	

	
    var data_entered =  document.getElementById("entry").value;

	if (document.querySelector("#operation").value == "add" && data_entered > 0)
	{

		total = (total + parseFloat(data_entered));
		current = parseFloat(data_entered);
		type = "+";
		array[position] = current;
		arraytype[position] = type;
		arraynumber[position] = position;
		getrightsub[position] = total;
		position++;
		positionfake++;
	}
	if (data_entered.charCodeAt(0) == "43") 
    {
        removeadd = data_entered.substring(1);
        total = (total + parseFloat(removeadd));
		current = parseFloat(removeadd);
		type = "+";
		array[position] = current;
		arraytype[position] = type;
		arraynumber[position] = position;
		getrightsub[position] = total;
		position++;
		positionfake++;
    
    }
	
	if (document.querySelector("#operation").value == "subtract" && data_entered > 0)
	{

		total = (total - parseFloat(data_entered));
		current = parseFloat(data_entered);
		type = "-";
		array[position] = current;
		arraytype[position] = type;
		arraynumber[position] = position;
		getrightsub[position] = total;
		position++;
		positionfake++;
	}
	
	if (data_entered.charCodeAt(0) == "45")
	{
        removesubtract = data_entered.substring(1);
		total = (total - parseFloat(removesubtract));
		current = parseFloat(removesubtract);
		type = "-";
		array[position] = current;
		arraytype[position] = type;
		arraynumber[position] = position;
		getrightsub[position] = total;
		position++;
		positionfake++;
	}	
	
	
	
	if (document.querySelector("#operation").value == "multiply" && data_entered > 0)
	{

		total = (total * parseFloat(data_entered));
		current = parseFloat(data_entered);
		type = "*";
		array[position] = current;
		arraytype[position] = type;
		arraynumber[position] = position;
		getrightsub[position] = total;
		position++;
		positionfake++;
	}
	if (data_entered.charCodeAt(0) == "42")
	{
        removemultiply = data_entered.substring(1);
		total = (total * parseFloat(removemultiply));
		current = parseFloat(removemultiply);
		type = "*";
		array[position] = current;
		arraytype[position] = type;
		arraynumber[position] = position;
		getrightsub[position] = total;
		position++;
		positionfake++;
	}	
	
	
	if (document.querySelector("#operation").value == "divide" && data_entered > 0)
	{

		total = (total / parseFloat(data_entered));
		current = parseFloat(data_entered);
		type = "/";
		array[position] = current;
		arraytype[position] = type;
		arraynumber[position] = position;
		getrightsub[position] = total;
		position++;
		positionfake++;
	}
	if (data_entered.charCodeAt(0) == "47")
	{
        removedivide = data_entered.substring(1);
		total = (total / parseFloat(removedivide));
		current = parseFloat(removedivide);
		type = "/";
		array[position] = current;
		arraytype[position] = type;
		arraynumber[position] = position;
		getrightsub[position] = total;
		position++;
		positionfake++;
	}
	
   /////PERCENTAGE 
   
   	if (document.querySelector("#operation").value == "pp" && data_entered > 0)
	{
        //(total + ((per /100) * total));
		//total = (total / parseFloat(data_entered));
		total = (total + (parseFloat(data_entered) / 100) * total);
		current = parseFloat(data_entered);
		type = "%";
		array[position] = current;
		arraytype[position] = type;
		arraynumber[position] = position;
		getrightsub[position] = total;
		position++;
		positionfake++;
	}
   	if (data_entered.charCodeAt(0) == "112")
	{
        //(total + ((per /100) * total));
		//total = (total / parseFloat(data_entered));
		removep = data_entered.substring(1);
		total = (total + (parseFloat(removep) / 100) * total);
		current = parseFloat(removep);
		type = "%";
		array[position] = current;
		arraytype[position] = type;
		arraynumber[position] = position;
		getrightsub[position] = total;
		position++;
		positionfake++;
	}
   	if (document.querySelector("#operation").value == "mp" && data_entered > 0)
	{
        //(total + ((per /100) * total));
		//total = (total / parseFloat(data_entered));
		total = (total - (parseFloat(data_entered) / 100) * total);
		current = parseFloat(data_entered);
		type = "-%";
		array[position] = current;
		arraytype[position] = type;
		arraynumber[position] = position;
		getrightsub[position] = total;
		position++;
		positionfake++;
	}	
	
   	if (data_entered.charCodeAt(0) == "109")
	{
        //(total + ((per /100) * total));
		//total = (total / parseFloat(data_entered));
		removem = data_entered.substring(1);
		total = (total - (parseFloat(removem) / 100) * total);
		current = parseFloat(removem);
		type = "-%";
		array[position] = current;
		arraytype[position] = type;
		arraynumber[position] = position;
		getrightsub[position] = total;
		position++;
		positionfake++;
	}	
	
	

	document.querySelector("#mycTable tbody").innerHTML = "";
	 //$("#mycTable tbody").empty();
	 mylength = array.length;
	//$('#mycTable tbody').append('<tr class="child"><td class="aleft">' + total +'</td><td class="aright">' + type + ' ' + current + '</td></tr>');
	
	
	 for (var b = 0; b < mylength; b++)
	 {
	 	subtotal = getrightsub[b];
	    var newnumber = arraynumber[b] + 1;

		if (array[b] != 0) {
		listnumber++;
		let elem = document.querySelector('#mycTable tbody');
	    elem.innerHTML = '<tr class="child"><td class="aleft">ID.' + newnumber + '. ' + '(1/' + listnumber + ')' + '<div class="subtotalright">' + subtotal.toFixed(2) + '</div> ' + '</td><td class="aright">' + ' ' + arraytype[b] +' ' + array[b].toFixed(2) + '</td></tr>' + elem.innerHTML;
	    
		}
	 }
	 subtotal = 0;	
	 listnumber = 0;
	
	var x=document.getElementById('mycTable2');
	x.innerHTML="Total = " + total.toFixed(2);
	
	var s = document.getElementById("entry");
    s.value = "";	
	
    document.getElementById("total").value=total.toFixed(2);
	document.getElementById("tvalues").innerHTML=total.toFixed(2);
	

	
  
  
}




function delete_entry() {
	
	document.querySelector("#mycTable tbody").innerHTML = "";
	//$("#mycTable tbody").empty();
	
	var table = document.getElementById("mycTable");
	var x=document.getElementById('mycTable2');
	
	del_entry = document.getElementById("del").value;
	var tempentry = del_entry - 1;
	
	if (arraytype[tempentry] == "+" && del_entry >= 0)
	{

	
	
	//current = array[del_entry];	
	//array.splice(del_entry, 1); 
    previous = (tempentry - 1);
	onlyone = (array[previous] - parseFloat(array[tempentry]));
   // arrayRemove(array, previous);
	//arrayRemove(array, tempentry);
	
	arraytype[tempentry] = 0;
	
	total = (total + onlyone);
	array[tempentry] = 0;
	total = 0;
	getrightsub = [];
	for (let i = 0; i < array.length; i++)
	{
		//total = (total + array[i]);
		if (arraytype[i] == "*")
		total = (total * array[i]);
		if (arraytype[i] == "/")
		total = (total / array[i]);
		if (arraytype[i] == "+")
		total = (total + array[i]);
		if (arraytype[i] == "-")
		total = (total - array[i]);
		if (arraytype[i] == "-%")		
		total = (total - (parseFloat(array[i]) / 100) * total);
		if (arraytype[i] == "%")	
		total = (total + (parseFloat(array[i]) / 100) * total);		

		getrightsub[i] = total;
		
	}

	//array[tempentry] = 0;
	
	x.innerHTML="Total = " + total;
	//var mylength = array.length - 1;
	//$('#mycTable tbody').append('<tr class="child"><td class="aleft">' + total +'</td><td class="aright">' + mylength + '. ' + '-' + ' ' + current + '</td></tr>');

	
	}
	if (arraytype[tempentry] == "/" && del_entry >= 0)
	{
	// WORKING FULLY ///////////////////////////////////////////////////////////
    previous = (tempentry - 1);
	onlyone = (array[previous] * parseFloat(array[tempentry]));
   // arrayRemove(array, previous);
	//arrayRemove(array, tempentry);
	
    arraytype[tempentry] = 0;
	
	total = (total + onlyone);
	array[tempentry] = 0;
	total = 0;
	getrightsub = [];
	for (let i = 0; i < array.length; i++)
	{
		if (arraytype[i] == "*")
		total = (total * array[i]);
		if (arraytype[i] == "/")
		total = (total / array[i]);
		if (arraytype[i] == "+")
		total = (total + array[i]);
		if (arraytype[i] == "-")
		total = (total - array[i]);
		if (arraytype[i] == "-%")		
		total = (total - (parseFloat(array[i]) / 100) * total);
		if (arraytype[i] == "%")	
		total = (total + (parseFloat(array[i]) / 100) * total);	
		
		getrightsub[i] = total;
		
	}

	//array[tempentry] = 0;
	
	x.innerHTML="Total = " + total;
	// WORKING FULLY ///////////////////////////////////////////////////////////////
	//current = array[del_entry];	
	//var mynewentry = del_entry;
	//current = array[del_entry];	
	//array.splice(mynewentry); 
	//total = total * array[del_entry];
	//var mylength = array.length - 1;
	//$('#mycTable tbody').append('<tr class="child"><td class="aleft">' + total +'</td><td class="aright">' + mylength + '. ' + '-' + ' ' + current + '</td></tr>');
	//array[del_entry] = 0;
	
	}
	if (arraytype[tempentry] == "*" && del_entry >= 0)
	{
    previous = (tempentry - 1);
	onlyone = (array[previous] / parseFloat(array[tempentry]));
   // arrayRemove(array, previous);
	//arrayRemove(array, tempentry);
	
	arraytype[tempentry] = 0;
	
	total = (total + onlyone);
	array[tempentry] = 0;
	total = 0;
	getrightsub = [];
	for (let i = 0; i < array.length; i++)
	{

		if (arraytype[i] == "*")
		total = (total * array[i]);
		if (arraytype[i] == "/")
		total = (total / array[i]);
		if (arraytype[i] == "+")
		total = (total + array[i]);
		if (arraytype[i] == "-")
		total = (total - array[i]);	
		if (arraytype[i] == "-%")		
		total = (total - (parseFloat(array[i]) / 100) * total);
		if (arraytype[i] == "%")	
		total = (total + (parseFloat(array[i]) / 100) * total);	
		
		getrightsub[i] = total;
		
	}

	//array[tempentry] = 0;
	
	x.innerHTML="Total = " + total;
	//current = array[del_entry];	
	//var mynewentry = del_entry;
	//current = array[del_entry];	
	//array.splice(mynewentry);
	//total = total / array[del_entry];	
	//var mylength = array.length - 1;
	//$('#mycTable tbody').append('<tr class="child"><td class="aleft">' + total +'</td><td class="aright">' + mylength + '. ' + '-' + ' ' + current + '</td></tr>');
	//array[del_entry] = 0;
	
	}
	if (arraytype[tempentry] == "-" && del_entry >= 0)
	{
	
    previous = (tempentry - 1);
	onlyone = (array[previous] + parseFloat(array[tempentry]));
   // arrayRemove(array, previous);
	//arrayRemove(array, tempentry);
	
    arraytype[tempentry] = 0;
	
	total = (total + onlyone);
	array[tempentry] = 0;
	total = 0;
	getrightsub = [];
	for (let i = 0; i < array.length; i++)
	{
		//total = (total + array[i]);
		if (arraytype[i] == "*")
		total = (total * array[i]);
		if (arraytype[i] == "/")
		total = (total / array[i]);
		if (arraytype[i] == "+")
		total = (total + array[i]);
		if (arraytype[i] == "-")
		total = (total - array[i]);
		if (arraytype[i] == "-%")		
		total = (total - (parseFloat(array[i]) / 100) * total);
		if (arraytype[i] == "%")	
		total = (total + (parseFloat(array[i]) / 100) * total);	
		
		getrightsub[i] = total;
		
	}

	//array[tempentry] = 0;
	
	x.innerHTML="Total = " + total;
	//current = array[del_entry];	
	//var mynewentry = del_entry;
	//current = array[del_entry];	
	//array.splice(mynewentry);
	//total = total + array[del_entry];
	//var mylength = array.length - 1;
//	$('#mycTable tbody').append('<tr class="child"><td class="aleft">' + total +'</td><td class="aright">' + mylength + '. ' + '+' + ' ' + current + '</td></tr>');
	//array[del_entry] = 0;
	}
	
	
	///// PERCENTAGE ////////////////////////////////////////////////
	
	if (arraytype[tempentry] == "-%" && del_entry >= 0)
	{
	//		total = (total + (parseFloat(data_entered) / 100) * total);
    previous = (tempentry - 1);
	onlyone = (array[previous] + (parseFloat(array[tempentry]) / 100) * total);
   // arrayRemove(array, previous);
	//arrayRemove(array, tempentry);
    arraytype[tempentry] = 0;
	
	
	total = (total + onlyone);
	array[tempentry] = 0;
	total = 0;
	getrightsub = [];
	for (let i = 0; i < array.length; i++)
	{
		if (arraytype[i] == "*")
		total = (total * array[i]);
		if (arraytype[i] == "/")
		total = (total / array[i]);
		if (arraytype[i] == "+")
		total = (total + array[i]);
		if (arraytype[i] == "-")
		total = (total - array[i]);
		if (arraytype[i] == "-%")		
		total = (total - (parseFloat(array[i]) / 100) * total);
		if (arraytype[i] == "%")	
		total = (total + (parseFloat(array[i]) / 100) * total);	
		
		getrightsub[i] = total;
		
	}
	
		
	x.innerHTML="Total = " + total;
	//current = array[del_entry];	
	//var mynewentry = del_entry;
	//current = array[del_entry];	
	//array.splice(mynewentry);
	//total = total + array[del_entry];
	//var mylength = array.length - 1;
//	$('#mycTable tbody').append('<tr class="child"><td class="aleft">' + total +'</td><td class="aright">' + mylength + '. ' + '+' + ' ' + current + '</td></tr>');
	//array[del_entry] = 0;
	}
	
	if (arraytype[tempentry] == "%" && del_entry >= 0)
	{
	//		total = (total + (parseFloat(data_entered) / 100) * total);
    previous = (tempentry - 1);
	onlyone = (array[previous] - (parseFloat(array[tempentry]) / 100) * total);
   // arrayRemove(array, previous);
	//arrayRemove(array, tempentry);
	arraytype[tempentry] = 0;
	
	total = (total + onlyone);
	array[tempentry] = 0;
	total = 0;
	getrightsub = [];
	for (let i = 0; i < array.length; i++)
	{
		if (arraytype[i] == "*")
		total = (total * array[i]);
		if (arraytype[i] == "/")
		total = (total / array[i]);
		if (arraytype[i] == "+")
		total = (total + array[i]);
		if (arraytype[i] == "-")
		total = (total - array[i]);
		if (arraytype[i] == "-%")		
		total = (total - (parseFloat(array[i]) / 100) * total);
		if (arraytype[i] == "%")	
		total = (total + (parseFloat(array[i]) / 100) * total);			
		getrightsub[i] = total;
		
	}

	//array[tempentry] = 0;
	
	x.innerHTML="Total = " + total;
	//current = array[del_entry];	
	//var mynewentry = del_entry;
	//current = array[del_entry];	
	//array.splice(mynewentry);
	//total = total + array[del_entry];
	//var mylength = array.length - 1;
//	$('#mycTable tbody').append('<tr class="child"><td class="aleft">' + total +'</td><td class="aright">' + mylength + '. ' + '+' + ' ' + current + '</td></tr>');
	//array[del_entry] = 0;
	}
	
	
	
	
	

	 for (var b = 0; b < mylength; b++)
	 {
	 	subtotal = getrightsub[b];
	    var newnumber = arraynumber[b] + 1;
		
		if (array[b] != 0) {
		listnumber++;
		let elem = document.querySelector('#mycTable tbody');
	    elem.innerHTML = '<tr class="child"><td class="aleft">ID.' + newnumber + '. ' + '(1/' + listnumber + ')' + '<div class="subtotalright">' + subtotal.toFixed(2) + '</div>' + '</td><td class="aright">' + ' ' + arraytype[b] +' ' + array[b].toFixed(2) + '</td></tr>' + elem.innerHTML;
		}
	 }
	 subtotal = 0;
	 listnumber = 0;
	 
	var x=document.getElementById('mycTable2');
	x.innerHTML="Total = " + total.toFixed(2);
	 
	document.getElementById("total").value=total.toFixed(2);
	var s = document.getElementById("entry");
    s.value = "";

	
	
}

function arrayRemove(arr, value) {

   return arr.filter(function(ele){
       return ele != value;
   });

}
function clearit() {
	document.querySelector("#mycTable tbody").innerHTML = "";
	//$("#mycTable tbody").empty();
	var zero = 0;
	var z=document.getElementById('mycTable2');
	z.innerHTML="Total = " + zero.toFixed(2);
	document.getElementById("total").value=zero.toFixed(2);
	total = 0;
	position = 0;
	current = 0;
	type = ""; 
	array = [];
	arraytype = [];
	arraynumber = [];
	del_entry = 0;
	positionfake = 0;
	mylength = 0;
	subtotal = 0;
	listnumber = 0;
    getrightsub = [];
	
	
}




</script>
<script>
    function saveFile() {
    	
    var data = [0];	
    data[0] = "TOTAL = " + total.toFixed(2) + "\r\n\r\n";
    	
	 for (var b = 0; b < mylength; b++)
	 {
	 	subtotal = getrightsub[b];
	    var newnumber = arraynumber[b] + 1;

		if (array[b] != 0) {
		listnumber++;
		data[b+1] = "(1/" + listnumber + ")" + "    "  + "Subtotal: " + subtotal.toFixed(2) + "    " + "Entry: " + arraytype[b] + " " + array[b].toFixed(2) + "\r\n\r\n";
	    
		}
	 }        
        // This variable stores all the data.
        
        // Convert the text to BLOB.
        var data2stringnocoma = data.join("");
        var data2string = data2stringnocoma.toString();
        const textToBLOB = new Blob([data2string], { type: 'text/plain' });
        const sFileName = 'adding-machine-calculator.txt';	   // The file to save the data.

        let newLink = document.createElement("a");
        newLink.download = sFileName;

        if (window.webkitURL != null) {
            newLink.href = window.webkitURL.createObjectURL(textToBLOB);
        }
        else {
            newLink.href = window.URL.createObjectURL(textToBLOB);
            newLink.style.display = "none";
            document.body.appendChild(newLink);
        }

        newLink.click(); 
    };
    

</script>
<link rel="stylesheet" href="calcstyle.css" type="text/css" media="all" />
</head>
<body>
<div id="mainbox">
<div id="ghost">
<div id="title">Adding Machine Calculator<span class="about"><i>&nbsp;&nbsp;Personal Finance</i></span></div>
<div id="footer">
<input type="button" value="Clear" class="clear" onclick="clearit()">
<input type="button" value="Print" class="clear" onclick="print()">
</div>

<input type="text" value="Total:" class="totallabel" readonly><input type="text" value="0.00" class="total" id="total" readonly>
<input type="text" value="Operation" class="totallabel2" readonly><input type="text" value="Entry" class="totallabel2" readonly>
<select id="operation" class="operation">
  <option value="auto">auto</option>
  <option value="add">+ (auto = +num)</option>
  <option value="subtract">&minus; (auto = -num)</option>
  <option value="multiply" >&times; (auto = *num)</option>
  <option value="divide" >&divide; (auto = /num)</option>
  <option value="pp" >+% (auto = pnum)</option>
  <option value="mp" >&minus;% (auto = mnum)</option>
</select>
<input type="string" name="entry" class="entry" id="entry" value="">
<input type="button" value="Enter" class="enter" onclick="submit()" id="enter">
<input type="button" value="Save" class="delete" onclick="saveFile()">
<input type="button" value="Delete" class="delete" onclick="delete_entry()">
<input type="number"   name="del" class= "del" id = "del" value="1">
<label for="del" class="labelit">ID#</label>
<table style="width:900px;" id="mycTable2">
<tbody>
<tr>
</tr>
</tbody>
</table>
<table style="width:900px;" id="mycTable">
<thead>
  <tr>
    <th class="tvalue" style="border-bottom: 1px solid #aaa;">ID&nbsp;&nbsp;<div id="subr">Sub-Total</div></th>
    <th class="cvalue" style="border-bottom: 1px solid #aaa;">Entry</th> 
  </tr></thead>
        <tbody id="tbody">
  
        </tbody>
</table>
</div></div>
</body>
</html>
<script>
document.onkeypress = function(e) {
    e = e || window.event;
    //if (e.keyCode == "13")
    if (e.key === "Enter")
    submit();

}
</script>
